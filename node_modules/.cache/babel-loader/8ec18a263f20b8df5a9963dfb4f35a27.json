{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\React\\\\coderhouse\\\\src\\\\components\\\\Orden\\\\Orden.js\";\nimport React, { useEffect, useState, useContext } from 'react';\nimport { getFirestore } from '../../firebase';\nimport { CartContext } from '../../components/Context/CartContext.js';\nimport \"./formulario.css\";\nimport { Redirect } from \"react-router-dom\";\nimport * as firebase from 'firebase/app';\nimport 'firebase/firestore';\n\nconst Orden = props => {\n  const db = getFirestore();\n  const orders = db.collection(\"orders\");\n  const [loading, setLoading] = useState(false);\n  const [order, setOrderId] = useState();\n  const [error, setError] = useState();\n  const [cart] = React.useContext(CartContext);\n  const [inputs, setInputs] = useState({});\n  const [total, setTotal] = useState({});\n\n  const handleChange = e => {\n    // Con esto accederemos a las propiedades del evento de forma asíncrona\n    e.persist(); // Ahora llamamos a la función, le pasamos el estado actual y le pasamos también el nombre del campo y su valor. Lo guardará justamente como un objeto\n\n    setInputs(inputs => ({ ...inputs,\n      [e.target]: e.target.value,\n      [e.target.apellido]: e.target.value,\n      [e.target.telefono]: e.target.value,\n      [e.target.email]: e.target.value,\n      [e.target.Remail]: e.target.value\n    }));\n  };\n\n  function Footer(props) {\n    return /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"totalPrice\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 12\n      }\n    }, \" Total: $\", props.total, \" \");\n  }\n\n  function renderRedirect() {\n    window.location.href = \"/gracias\";\n  }\n\n  const newOrder = {\n    buyer: inputs,\n    items: cart,\n    total: cart.reduce((a, c) => a + c.product.precio * c.count, 0),\n    date: firebase.firestore.Timestamp.fromDate(new Date())\n  }; // Set the Cart Context with the added product\n\n  const enviar = () => {\n    orders.add(newOrder).then(({\n      id\n    }) => {\n      setOrderId(id);\n      renderRedirect();\n    }).catch(err => {\n      setError(err);\n    }).finally(() => {\n      setLoading(false);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"tituloOrden mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, \" \\xA1\\xDAltimo paso! \"), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"formulario\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 11\n    }\n  }, \"Nombre\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"name\",\n    name: \"name\",\n    className: \"form-control\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"apellido\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }, \"Apellido\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"apellido\",\n    name: \"apellido\",\n    className: \"form-control\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"telefono\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, \"Telefono\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"number\",\n    id: \"telefono\",\n    name: \"telefono\",\n    className: \"form-control\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"Emai\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 11\n    }\n  }, \"Email\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"email\",\n    name: \"email\",\n    className: \"form-control\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"ReEmail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 11\n    }\n  }, \"Confirmar Email\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"Remail\",\n    name: \"Remail\",\n    className: \"form-control\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Footer, {\n    total: cart.reduce((a, c) => a + c.product.precio * c.count, 0),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-primary botonOrden mt-3\",\n    onClick: enviar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, \" Enviar\"));\n};\n\nexport default Orden;","map":{"version":3,"sources":["C:/xampp/htdocs/React/coderhouse/src/components/Orden/Orden.js"],"names":["React","useEffect","useState","useContext","getFirestore","CartContext","Redirect","firebase","Orden","props","db","orders","collection","loading","setLoading","order","setOrderId","error","setError","cart","inputs","setInputs","total","setTotal","handleChange","e","persist","target","value","apellido","telefono","email","Remail","Footer","renderRedirect","window","location","href","newOrder","buyer","items","reduce","a","c","product","precio","count","date","firestore","Timestamp","fromDate","Date","enviar","add","then","id","catch","err","finally"],"mappings":"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","sourcesContent":["\r\nimport React, {useEffect, useState, useContext} from 'react';\r\nimport { getFirestore } from '../../firebase';\r\nimport { CartContext } from '../../components/Context/CartContext.js';\r\nimport \"./formulario.css\"\r\nimport { Redirect } from \"react-router-dom\";\r\nimport * as firebase from 'firebase/app';\r\nimport 'firebase/firestore';\r\n\r\n\r\n\r\nconst Orden = (props) => {\r\n  const db = getFirestore();\r\n  const orders = db.collection(\"orders\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [order, setOrderId] = useState();\r\n  const [error, setError] = useState();\r\n  const [cart] = React.useContext(CartContext);\r\n  const [inputs, setInputs] = useState({});\r\n  const [total, setTotal] = useState({});\r\n\r\n\r\n  const handleChange = e => {\r\n          // Con esto accederemos a las propiedades del evento de forma asíncrona\r\n          e.persist()\r\n          // Ahora llamamos a la función, le pasamos el estado actual y le pasamos también el nombre del campo y su valor. Lo guardará justamente como un objeto\r\n          setInputs(inputs => ({ ...inputs, [e.target]: e.target.value, [e.target.apellido]: e.target.value, [e.target.telefono]: e.target.value, [e.target.email]: e.target.value, [e.target.Remail]: e.target.value}))\r\n  }\r\n\r\n\r\n  function Footer(props){\r\n    return <h2 className=\"totalPrice\"> Total: ${props.total} </h2>\r\n  }\r\n\r\n  function renderRedirect(){\r\n   window.location.href = \"/gracias\";\r\n}\r\n  const newOrder = {\r\n      buyer: inputs,\r\n      items : cart,\r\n      total : cart.reduce((a,c) => (a+c.product.precio*c.count), 0),\r\n      date: firebase.firestore.Timestamp.fromDate(new Date()),\r\n  };\r\n\r\n  // Set the Cart Context with the added product\r\n  const enviar = () => {\r\n    orders.add(newOrder).then(({id}) =>{\r\n      setOrderId(id);\r\n    renderRedirect();\r\n    }).catch(err => {\r\n      setError(err);\r\n    }).finally(() =>{\r\n      setLoading(false);\r\n    })  }\r\n\r\n\r\n  return (\r\n      <div>\r\n      <p className=\"tituloOrden mt-3\"> ¡Último paso! </p>\r\n      <form className=\"formulario\">\r\n          <label htmlFor='name'>Nombre</label>\r\n          <input type='text' id=\"name\" name='name' className=\"form-control\" onChange={handleChange} />\r\n          <label htmlFor='apellido'>Apellido</label>\r\n          <input type='text' id=\"apellido\" name='apellido' className=\"form-control\" onChange={handleChange} />\r\n          <label htmlFor='telefono'>Telefono</label>\r\n          <input type='number' id=\"telefono\" name='telefono' className=\"form-control\" onChange={handleChange} />\r\n          <label htmlFor='Emai'>Email</label>\r\n          <input type='text' id=\"email\" name='email' className=\"form-control\" onChange={handleChange} />\r\n          <label htmlFor='ReEmail'>Confirmar Email</label>\r\n          <input type='text' id=\"Remail\" name='Remail' className=\"form-control\" onChange={handleChange} />\r\n      </form>\r\n      <Footer total={cart.reduce((a,c) => (a+c.product.precio*c.count), 0)} />\r\n\r\n      <button className=\"btn btn-primary botonOrden mt-3\" onClick={enviar}> Enviar</button>\r\n      </div>\r\n  );\r\n}\r\n\r\nexport default Orden;\r\n"]},"metadata":{},"sourceType":"module"}